var windowHeight=window.screen.height;var cdn_domain="https://cdn.getnewseveryday.com";function news(){var e=this;var t=document.getElementById("news_body").getElementsByTagName("img");e.news_body=document.getElementById("news_body");e.source_img=document.getElementsByClassName("source_pic")[0].children[0];e.main=document.getElementsByClassName("main")[0];e.bodynode=document.getElementsByTagName("body")[0];e.img_collection=[];e.lang_type="ja";if(document.getElementsByName("channel_lang")[0]){e.lang_type=document.getElementsByName("channel_lang")[0].getAttribute("content")}if(document.getElementsByName("source_pic")[0]){var n=document.getElementsByName("source_pic")[0].getAttribute("content");var i=e.source_img.getAttribute("height");var o=document.getElementsByClassName("source_pic")[0].offsetHeight;var a=e.source_img.getAttribute("width");var r=a/i*o;e.source_img.setAttribute("src",n);e.source_img.style.width=r+"px";e.source_img.onerror=function(){var t=e.source_img.getAttribute("height");e.source_img.setAttribute("width",t);e.source_img.setAttribute("src",cdn_domain+"/icons/article/source_default@3x.png")}}for(var s=0;s<t.length;s++){e.img_collection.push({img_node:t[s],isload:false})}document.addEventListener("click",function(e){if(e.target.tagName=="A"){var t=e.target.getAttribute("href");e.preventDefault();bridge.post("open_url",{url:"local://web?url="+t})}if(e.target.tagName=="IMG"){e.preventDefault()}});e.addLinkNode();change_fontsize();var c=setInterval(function(){if(document.getElementById("news_body").clientWidth!=0){for(var t=0;t<e.img_collection.length;t++){load_image(t,function(t){e.replaceImgSrc(e.img_collection[t.index].img_node,t.file_path);e.img_collection[t.index].img_node.setAttribute("index",t.index);e.img_collection[t.index].img_node.tap(function(){show_image(this.getAttribute("index"),this.getAttribute("src"))})})}clearInterval(c)}},0);for(var s=0;s<document.getElementsByTagName("script").length;s++){var l=/UA\-\d{5,20}\-\d{1,10}/.exec(JSON.stringify(document.getElementsByTagName("script")[s].innerHTML));if(l&&l.length>0){var d=l[0]}}if(d){var g="";var m=document.getElementsByClassName("article_info")[0];if(m){g=m.getAttribute("origin_source")}ga_send("iframe",d,"http://test.api.bigappinfo.com/webnews/ga?utm_source=newsjet&utm_medium=display&refer=newsjet&action=pv&op="+g,document.body)}}news.prototype.addLinkNode=function(){var e=this;var t=0;var n=0;if(document.getElementsByName("fe_flag")[0]){n=parseInt(document.getElementsByName("fe_flag")[0].getAttribute("content"))}if(document.getElementsByName("crtype")[0]){t=parseInt(document.getElementsByName("crtype")[0].getAttribute("content"))}if(n==1||t!=4){var i=document.createElement("div");i.className="to_web";i.innerHTML=lang[e.lang_type].Common_ReadThisOnTheWeb+"<i></i>";e.main.appendChild(i);i.tap(function(){open_original_url()})}};news.prototype.replaceDefault=function(){var e=this;for(var t=0;t<e.img_collection.length;t++){if(e.load_condition(e.img_collection[t].img_node)&&!e.img_collection[t].isload){e.img_collection[t].isload=true;load_image(t,function(t){e.replaceImgSrc(e.img_collection[t.index].img_node,t.file_path);e.img_collection[t.index].img_node.setAttribute("index",t.index)});e.img_collection[t].img_node.tap(function(){show_image(this.getAttribute("index"),this.getAttribute("src"))})}}};news.prototype.addDefaultSrc=function(){var e=this;for(var t=0;t<e.img_collection.length;t++){e.replaceImgSrc(e.img_collection[t].img_node,cdn_domain+"/nstatic/news/image/news_detail_before_default_pic.png")}};news.prototype.load_condition=function(e){var t=e.offsetTop-document.body.scrollTop;if(t<windowHeight+200){return true}return false};news.prototype.replaceImgSrc=function(e,t){var n=this;var i=e.getAttribute("width"),o=e.getAttribute("height"),a=n.main.clientWidth,r=o/i*a;e.setAttribute("src",t);if(e.className.indexOf("avatar_img")==-1){e.style.width=a+"px";e.style.height=r+"px"}e.addEventListener("error",function(){var t=document.createElement("div");var n=document.createElement("img");var i=e.parentNode;if(i&&t&&e){n.setAttribute("src",cdn_domain+"/nstatic/news/image/news_detail_default_pic_2.png");t.className="news_pic";t.style.width=e.style.width;t.style.height=e.style.height;n.style.width=30+"px";n.style.height=30+"px";t.appendChild(n);i.replaceChild(t,e)}})};news.prototype.showVideo=function(){var e=this;var t=document.getElementsByTagName("video");for(var n=0;n<t.length;n++){var i=t[n];var o=i.parentNode;var a=i.getAttribute("poster");var r=i.getAttribute("src");i.style.display="none";i.setAttribute("src","");i.setAttribute("controls","controls");var s=document.createElement("img");s.src=a;s.onerror=function(){s.setAttribute("src",cdn_domain+"/nstatic/news/image/news_detail_default_pic_2.png")};s.onload=function(){if(this.width>this.height){this.style.width="100%";this.style.height="auto"}else{this.style.width="auto";this.style.height="100%"}};o.appendChild(s);var c=o.offsetWidth;var l=c/16*9;o.style.height=l+"px";o.tap(function(e){return function(){var t=document.getElementsByClassName("video_box")[e];t.getElementsByTagName("video")[0].src=r;t.getElementsByTagName("video")[0].style.display="block";t.getElementsByTagName("video")[0].play();t.getElementsByTagName("img")[0].style.display="none";t.getElementsByTagName("i")[0].style.display="none";t.getElementsByTagName("span")[0].style.display="none"}}(n))}};HTMLElement.prototype.tap=function(e){var t=0,n=0,i=200,o=0,a=0,r=0,s=0,c=7.5,l=false;this.addEventListener("touchstart",function(){t=event.timeStamp;o=event.changedTouches[0].clientX;r=event.changedTouches[0].clientY;l=false});this.addEventListener("touchmove",function(){a=event.changedTouches[0].clientX;s=event.changedTouches[0].clientY;if(Math.abs(o-a)>c||Math.abs(r-s)>c){l=true}});this.addEventListener("touchend",function(){n=event.timeStamp;if(!l&&n-t<=i){e.call(this)}})};window.onload=function(){var e=new news};function ga_send(e,t,n,i){var o=document.createElement(e);o.src=n;o.id="ifr";o.style.display="none";i.appendChild(o);o.onload=function(){var e=document.querySelector("#ifr");e.contentWindow.postMessage({ga_id:t},"*")}}function load_image(e,t){window.bridge.post("detail_action",{action_type:"load_image",index:e},t)}function show_image(e,t){window.bridge.post("detail_action",{action_type:"show_image",index:e,imgsrc:t})}function open_original_url(){window.bridge.post("detail_action",{action_type:"open_original_url"})}function change_fontsize(){window.bridge.on("change_font",function(e){document.getElementsByTagName("body")[0].className="font_"+e.font})}function is_ios(){if(!navigator){return false}if(!navigator.userAgent){return false}return/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)}